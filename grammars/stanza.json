{
  "scopeName": "source.stanza",
  "name": "stanza",
  "fileTypes": ["stanza"],
  "patterns": [
    {
      "match": ";.*",
      "name": "comment.line.stanza"
    },
    {
      "match": "^[ \t]*(#define|#if-defined|#if-not-defined|#else)",
      "name": "meta.keyword.compile_time_flags.stanza"
    },
    {
      "match": "^(defpackage)\\s+([a-zA-Z][\\w\\-]*)\\s*:$",
      "name": "meta.declaration.package.stanza",
      "captures": {
        "1": {
          "name": "storage.type.package.stanza"
        },
        "2": {
          "name": "entity.name.type.package.stanza"
        }
      }
    },
    {
      "match": "^(defn)\\s+([a-zA-Z][\\w\\-]*)\\s+",
      "name": "meta.declaration.function.stanza",
      "captures": {
        "1": {
          "name": "storage.type.function.stanza"
        },
        "2": {
          "name": "entity.name.function.stanza"
        }
      }
    },
    {
      "match": "[ \t,\\[\\](){}]"
    },
    {
      "match": "-?[0-9][^ \t,.:&|<>\\[\\]{}()]*",
      "name": "constant.numeric.stanza"
    },
    {
      "begin": "\"",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.string.begin.stanza"
        }
      },
      "end": "\"",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.stanza"
        }
      },
      "name": "string.quoted.double.stanza",
      "patterns": [
        {
          "match": "(?<!\\\\)%[_*,~@%]",
          "name": "keyword.other.interpolation.stanza"
        }
      ]
    },
    {
      "match": "[^ \t0-9~!@#$%^*+-=/.:&|<>][^ \t,.:&|<>\\[\\]{}()]*",
      "captures": {
        "0": {
          "patterns": [
            {
              "match": "^(?:[A-Z][A-Za-z0-9_]*)$",
              "name": "entity.name.type.stanza"
            },
            {
              "match": "^(?:defpackage|deftype|defstruct|defn\\*?|defmulti|defmethod\\*?|defsyntax|defrule|val|var|import|with|public|protected|extern)$",
              "name": "keyword.other.stanza"
            },
            {
              "match": "^(?:if|else|when|switch|match|let|let-var|where|for|while|label|break|generate|yield|try|catch|finally|throw|attempt|fn\\*?|multifn\\*?|qquote)$",
              "name": "keyword.control.stanza"
            },
            {
              "match": "^(new|to|through|by|in|and|or|not|as\\??|is)$",
              "name": "keyword.operator.stanza"
            },
            {
              "match": "^(true|false)$",
              "name": "constant.language.stanza"
            }
          ]
        }
      }
    },
    {
      "match": "[~!@#$%^*+-=/.:&|<>]+(?:[ \t]|$)",
      "name": "keyword.operator.stanza"
    }
  ]
}
